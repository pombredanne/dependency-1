@(person: com.bryzek.dependency.api.lib.Person,
  urls: com.bryzek.dependency.api.lib.Urls,
  newRecommendations: Seq[com.bryzek.dependency.v0.models.Recommendation],
  oldRecommendations: Seq[com.bryzek.dependency.v0.models.Recommendation],
  lastEmail: Option[db.LastEmail]
)

@if(!person.name.first.isEmpty) {
  <p>Dear @person.name.first.get,</p>
}

@if(lastEmail.isEmpty) {
  <p>

    Thanks for subscribing to your personalized daily summary of
    dependency recommendations. At any time, you can unsubscribe
    by visiting <a href="@urls.www(routes.SubscriptionsController.index())">@urls.www(routes.SubscriptionsController.index())</a>

  </p>

} else {

  <p>
    @{newRecommendations.size match {
      case 0 => "No new recommendations"
      case 1 => "1 new recommendation"
      case n => s"$n new recommendations"
    }}
    since your last summary sent on
    @io.flow.play.util.DateHelper.longDateTime(lastEmail.get.audit.createdAt).
  </p>
}

@if(!newRecommendations.isEmpty) {
  @recommendations(urls, newRecommendations)
}

@if(!oldRecommendations.isEmpty) {
  <p>As a reminder, here are your other outstanding upgrade recommendations</p>
  @recommendations(urls, oldRecommendations)
}

@footer(urls)
